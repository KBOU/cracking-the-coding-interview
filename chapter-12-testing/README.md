# テスト

問題に答えるときに以下の点に留意すべき。

* 全体像を把握すること
* それぞれのモジュールがどう関連するかを把握すること
* 課題をMECEでブレークダウンすること
* 現実的なテスト計画であること

また、テスト系の問題は大きく分けて、4パターンある。

1. 実在するものをテストする
    1. 誰がなんのために使うか
    2. ユースケース
    3. 境界条件
    4. 失敗しても良い条件、また失敗時の挙動
    5. どのようにテストを実施するか
2. ソフトウェアをテストする
    1. ブラックボックスかホワイトボックスか
    2. 誰がなんのために使うか
    3. ユースケース
    4. 境界条件
    5. 失敗しても良い条件、また失敗時の挙動
    6. どのようにテストを実施するか
3. 関数をテストする
    1. テストケースの定義
        * 通常ケース
        * 境界値
        * イリーガルインプット
        * 変わった値(全部0とかソート関数にソート済み配列を与えるとか)
    2. 期待する結果の定義
    3. テストコードを書く
4. トラブルシューティング
    1. 状況を把握
    2. ブレークダウンして該当箇所を見出す
    3. 該当箇所を特定した管理可能なテストを実施する


## 12-1. 関数の間違いを探せ！

1. unsignedなので0にはならないので無限ループする
2. unsignedなので%dではなく%u

unsignedをとるのがいいかと思います。


## 12-2. スタート時にクラッシュするアプリケーションがある。何が原因か？どうやってテストする？

1. デバッグしたところ、クラッシュする箇所がいつも違う
2. シングルスレッド
3. CのStandard Libraryしか使っていない。


条件3より、プログラム本体に問題がある可能性が高い。  
また、シングルスレッドにも関わらずクラッシュする箇所がいつも異なるということは、  
メモリ不足、CPUが100%、HDが足りない、ファイルハンドルを使い切った、ネットワークエラー  
などの外部環境との兼ね合いによってい引き起こされるエラーの可能性が高い。

それぞれマシンのリソースをほぼフルフルに使った状態でテストする。

### 追記

全然足りてませんね・・・

* ランダムナンバー
* 初期化されていない変数
* 外部依存(いやでもStandard Libraryしか使ってないのでは・・・？)

## 12-3. チェスのコマが特定のマスに進めるかどうか確認するメソッドのテスト

* 通常ケース
    * 4角にコマを置いてテスト(黒白,それぞれのコマ種)
    * 盤の中央にコマを置いてテスト(黒白,それぞれのコマ種)
* 進路に障害物がある
    * 進路に障害物があるケース
    * 近くに障害物があるがコマの移動範囲に影響を及ぼさないケース
* 特殊動作
    * キャスリング
    * ポーンの斜め前に敵がいる時の動き

### 追記

* 異常ケース
    * ボードの外座標
    * ボードをまんぱんにしたテスト
    * ボード上を空にしたテスト

## 12-4. テストツールを使わずにWebページの負荷テスト

* 複数スレッドを用いて大量同時接続
* 同時じゃなくてもいいけど大量アクセス


### 追記

やり方は悪くなかったけど、クライテリアがありませんね・・・

* レスポンスタイム
* スループット
* リソース
* 最大負荷

## 12-5. ペンをテスト

<table>
  <tr> <th>誰が何のために使う？</th> <td>メモを書くため</td> </tr>
  <tr> <th>ユースケース</th> <td>ノートにメモを書く</td> </tr>
  <tr> <th>使用条件</th> <td>摂氏0-50。適度な筆圧。</td> </tr>
  <tr> <th>壊れる/使えないケース</th> <td>摂氏0-50以外。強すぎる弱すぎる筆圧。100,000文字以上書いた</td> </tr>
</table>


* 書く対象
    * ノート
    * プラスチック
    * 木
* 筆圧
    * 筆圧が上限ギリギリで書く
    * 筆圧が上限ギリギリを越した状態で書く
    * 筆圧が下限ギリギリで書く
    * 筆圧が下限ギリギリを越した状態で書く
* 使用環境
    * 適温外で書く
    * 適温で書く
* 耐久性
    * 規定条件で100,000文字書く


## 12-6. ATMのテスト

### ATMの使い方

#### 引き落とし

1. カードを入れる
2. 引き落としを選択
3. 金額入力
4. 暗証番号入力
5. 暗証番号確認
6. 残高確認
7. 金額を出す
8. アカウントのアップデート
9. カードを返す
10. 領収書を出す

#### 口座情報確認

1. カードを入れる
2. 口座情報を確認を選択
3. 暗証番号入力
4. 暗証番号確認
5. 残高を表示
6. 領収書を出す

#### 預かり入れ

1. カードを入れる
2. 預かり入れを選択
3. 暗証番号入力
4. 暗証番号確認
5. お札を投入
6. アカウントのアップデート
7. 残高を表示
8. カードを返す
9. 領収書を出す


### ATMのテスト

* ATM単体のテスト
    * カードの挿入
    * 動作の入力
    * 金額入力
    * 暗証番号入力
    * お札の投入
    * お金を出す
    * カードの返却
    * 残高の表示
    * 領収書を出す
    * 異常ケース
        * 電源が操作途中で落ちる
* ATMとアカウントの連携
    * 暗証番号の確認
    * 残高の確認
    * 残高の更新
    * 異常ケース
        * ネットワークエラーが発生する
        * 頻繁に残高の更新をしてデッドロックが発生しないか
